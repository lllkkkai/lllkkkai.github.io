---
layout: post
category: Architecture
---

### **一、Java核心基础（考察底层原理与实战经验）**
1. **JVM调优**  
   - 如何排查频繁Full GC？解释CMS和G1的适用场景。  
   - 线上服务出现`OutOfMemoryError: Metaspace`，可能原因是什么？如何定位？  
   - **追问**：是否用过阿里开源的Arthas？举例解决过的实际问题。

2. **并发编程**  
   - 如何实现一个高性能的本地缓存（线程安全+过期策略）？
   - `ConcurrentHashMap`在JDK1.7和1.8中的实现差异？为什么1.8放弃分段锁？
   - **场景题**：用`CompletableFuture`优化三个异步RPC调用的聚合逻辑。

3. **Java 8+特性**
   - `Stream`的并行流原理？什么情况下使用可能引发问题？
   - 方法引用和Lambda在JVM层面的实现区别？

---

### **二、分布式系统设计（突出高并发、高可用经验）**
1. **秒杀系统设计**
   - 如何解决超卖问题？如何设计限流和降级策略？
   - **追问**：如果使用阿里云Redis集群，如何保证热点Key不过载？

2. **分布式事务**  
   - 对比Seata的AT模式与TCC模式，适用哪些业务场景？  
   - 如何设计一个最终一致性的跨服务订单支付系统？

3. **服务治理**  
   - 如何用Sentinel实现熔断和自适应流量控制？  
   - **场景题**：Nacos配置中心突然宕机，如何保证微服务正常运行？

---

### **三、中间件与数据库（结合阿里技术栈）**
1. **RocketMQ**  
   - 消息重复消费的根本原因？如何保证业务幂等性？
   - 如何设计一个延迟消息实现订单未支付自动关闭？

2. **分库分表**  
   - 订单表按用户ID分库，如何高效查询“某商家的所有订单”？  
   - 是否了解阿里云的DRDS？它的路由策略与自研方案差异？

3. **Redis深度**  
   - 大Key和热Key的解决方案？是否使用过阿里云的Tair？  
   - Redis集群脑裂问题如何规避？Raft协议与Redis Cluster的区别？

---

### **四、架构设计思维（业务抽象与权衡能力）**
1. **设计模式实战**  
   - 如何用策略模式+工厂模式替换订单系统中复杂的`if-else`逻辑？  
   - 举例说明你在项目中如何应用DDD解决领域模型混乱的问题。

2. **系统重构经验**  
   - 描述一个将单体系统拆分为微服务的案例，遇到的最大挑战是什么？  
   - **追问**：如何保证拆分过程中数据一致性和服务可用性？

3. **容灾与高可用**  
   - 如何设计异地多活架构？CAP中如何权衡一致性与可用性？  
   - 全链路压测如何实施？如何模拟阿里双十一的洪峰流量？

---

### **五、编码能力（动手能力验证）**
1. **手写代码**  
   - 实现一个线程安全的LRU缓存，支持设置过期时间。  
   - 用`ReentrantLock`和`Condition`实现阻塞队列。

2. **算法题**  
   - 二叉树层序遍历（考察基础编码规范）  
   - 接雨水问题（优化至O(n)时间复杂度）

---

### **六、项目深挖（STAR法则深度追问）**
- **挑战性项目**：选择一个你主导的高并发项目，详细说明：  
  - 架构设计的关键决策点（如为什么选择Kafka而非RocketMQ）  
  - 遇到的最大技术难点及解决方案（如分布式锁性能瓶颈）  
  - 如果重做一次，会在哪些方面改进？

---

### **考察重点总结**
1. **深度而非广度**：对核心技术的底层理解（如JVM、并发源码）。  
2. **实战导向**：设计能力需结合真实场景，避免纯理论回答。  
3. **技术前瞻性**：对云原生、Serverless等趋势的见解。  
4. **文化匹配**：是否具备“拥抱变化”的心态和复杂问题拆解能力。

---


### **一、Java核心技术**
#### **1. JVM与性能优化**
- **问题**：  
  - 请解释CMS和G1垃圾回收器的区别，G1为什么适合大堆内存场景？  
  - 如何排查线上服务的频繁Full GC问题？  
  - JVM内存模型中的TLAB（Thread Local Allocation Buffer）是什么？它的作用是什么？  

#### **2. 并发编程**
- **问题**：  
  - `ConcurrentHashMap`在JDK1.7和1.8中的实现差异是什么？为什么1.8改用CAS+synchronized？  
  - 如何实现一个高性能无锁队列？  
  - 解释`ThreadLocal`的内存泄漏问题及解决方案。  

#### **3. Java新特性**
- **问题**：  
  - Java 17中的Sealed Classes（密封类）解决了什么问题？  
  - 如何使用Project Loom的虚拟线程（Virtual Threads）优化高并发场景？  

---

### **二、框架与中间件**
#### **1. Spring生态**
- **问题**：  
  - Spring Bean的生命周期是怎样的？如何通过`BeanPostProcessor`干预Bean的创建？  
  - Spring事务传播机制中，`REQUIRES_NEW`和`NESTED`的区别是什么？  
  - Spring Boot自动配置的原理是什么？如何自定义Starter？  

#### **2. 分布式中间件**
- **问题**：  
  - Redis的持久化机制RDB和AOF如何选择？混合持久化的实现原理是什么？  
  - Kafka如何保证消息的顺序性和Exactly-Once语义？  
  - 在分布式场景下，如何基于Redis实现一个高可用的延迟队列？  

#### **3. 数据库与ORM**
- **问题**：  
  - MySQL的索引下推（Index Condition Pushdown）是什么？如何通过执行计划判断是否生效？  
  - 分库分表后，如何实现全局唯一ID生成？  
  - MyBatis的`#{}`和`${}`的区别是什么？如何防止SQL注入？  

---

### **三、系统设计**
#### **1. 高并发设计**
- **问题**：  
  - 设计一个秒杀系统，如何解决超卖问题？如何应对瞬时高流量？  
  - 如何实现一个支持千万级用户的实时排行榜？  

#### **2. 分布式系统**
- **问题**：  
  - CAP理论中，为什么大多数分布式系统选择AP或CP？举例说明不同场景的选择逻辑。  
  - 如何设计一个分布式锁服务？对比Redis和ZooKeeper的实现方案。  

#### **3. 微服务架构**
- **问题**：  
  - 如何保证微服务之间的数据一致性？Saga模式和TCC模式的区别是什么？  
  - 服务网格（Service Mesh）解决了什么问题？对比Istio和Spring Cloud Gateway的设计思想。  

---

### **四、实战经验与软技能**
#### **1. 项目深挖**
- **问题**：  
  - 请描述你负责过最复杂的系统，你在其中解决了哪些技术难点？  
  - 如果让你重构一个遗留系统，你的核心步骤是什么？如何平衡重构与业务需求？  

#### **2. 故障排查**
- **问题**：  
  - 线上服务突然出现大量超时，如何快速定位问题？  
  - 如何排查一个Java应用的CPU飙高问题？  

#### **3. 软技能**
- **问题**：  
  - 在技术方案评审中，如何说服团队成员接受你的设计？  
  - 如何推动团队的技术债务治理？  

---

### **五、编码与算法**
#### **1. 手撕代码**
- **题目**：  
  - 实现一个线程安全的LRU缓存。  
  - 二叉树层序遍历的变种（如锯齿形遍历）。  

#### **2. 系统设计模拟**
- **题目**：  
  - 设计一个分布式文件存储系统，支持海量小文件的高效读写。  
  - 设计一个支持千万级用户同时在线的实时聊天系统。  

---

### **六、开放性问题**
- **问题**：  
  - 你如何看待云原生技术对传统Java开发的影响？  
  - 如果让你主导一个技术架构升级项目，你的核心考量点是什么？  

---

### **考察重点总结**
1. **技术深度**：能否深入原理层解释技术（如JVM、并发、框架源码）。  
2. **系统思维**：能否从架构设计、性能优化、容灾等维度思考问题。  
3. **实战能力**：能否结合项目经验，展示解决复杂问题的思路和方法。  
4. **学习能力**：是否关注技术趋势（如云原生、新版本Java特性）。  

---

### **加分项**
- 对开源项目的贡献或深度使用经验。  
- 对技术趋势的见解（如Serverless、Service Mesh）。  
- 在技术影响力方面的实践（如技术分享、团队培训）。  

一、缓存基础

• 什么是缓存？为什么要使用缓存？

• 答案：缓存是一种存储技术，用于临时存储数据，以便快速访问。使用缓存可以减少对数据库的访问压力，提高系统的读取速度，从而提升整体性能。

• 常见的缓存工具和框架有哪些？

• 答案：

• 本地缓存：Guava LocalCache、Ehcache、Caffeine。

• 分布式缓存：Redis、Memcached、Tair。

• 缓存的读写策略有哪些？

• 答案：

• 读策略：优先从缓存读取数据，如果缓存未命中，则从数据库加载数据并写入缓存。

• 写策略：通常采用“先更新数据库，再删除缓存”的策略。


二、缓存一致性

• 如何保证数据库与缓存的一致性？

• 答案：可以通过以下方式保证一致性：

• 双删策略：在更新数据库后，删除缓存中的旧数据，并在适当的时候更新缓存。

• 消息队列：使用消息队列（如RabbitMQ、Kafka）来异步更新缓存。

• Cache Aside机制是什么？它的优缺点是什么？

• 答案：

• 机制：读操作时，先从缓存读取，未命中则从数据库读取并写入缓存；写操作时，先更新数据库，再删除缓存。

• 优点：简单易实现，适用于读多写少的场景。

• 缺点：在高并发写操作下，可能会导致缓存命中率下降。


三、缓存设计问题

• 如何避免缓存穿透？

• 答案：

• 空对象缓存：即使数据不存在，也将空结果缓存起来，并设置较短的过期时间。

• 布隆过滤器：在缓存层之前使用布隆过滤器，快速判断数据是否存在。

• 如何避免缓存击穿？

• 答案：

• 互斥锁方案：使用Redis的`setNX`方法设置锁，保证同一时间只有一个线程更新缓存。

• 不设置过期时间：对于热点数据，不设置过期时间，通过后台服务定期更新缓存。

• 如何避免缓存雪崩？

• 答案：

• 设置不同的过期时间：为缓存数据设置不同的过期时间，避免大量数据同时过期。

• 使用持久化：利用Redis的持久化功能，即使缓存服务重启，也能从磁盘中恢复数据。

• 设置缓存永不过期：对于某些热点数据，可以设置为永不过期，通过程序定期更新缓存。


四、缓存性能优化

• 如何优化缓存的性能？

• 答案：

• 合理设置过期时间：根据数据的使用频率和重要性，设置合适的过期时间。

• 使用缓存预热：在系统启动时，预先加载热点数据到缓存中。

• 监控和优化热点key：通过监控工具（如Redis的`MONITOR`命令）找出热点key，并进行优化。

• 如何进行缓存预热？

• 答案：在系统启动时，通过脚本或程序将热点数据加载到缓存中。


五、分布式缓存

• 分布式缓存和本地缓存有什么区别？

• 答案：

• 本地缓存：存储在单个应用实例中，适合单机应用，性能高但无法共享。

• 分布式缓存：存储在多个节点上，适合分布式系统，支持高并发和数据共享。

• Redis和Memcached有什么区别？

• 答案：

• 数据结构：Redis支持多种数据结构（如字符串、列表、集合等），Memcached主要支持简单的键值对。

• 持久化：Redis支持持久化，Memcached不支持。

• 性能：Redis是单线程的，但通过多线程I/O实现了高性能读写。

• Redis的主从复制如何实现？

• 答案：通过全量复制和增量复制实现。主节点将数据同步到从节点，从节点可以作为备份或读副本。

• Redis的Sentinel和Cluster有什么区别？

• 答案：

• Sentinel：主要用于高可用性，通过主从复制和故障转移实现。

• Cluster：用于分布式存储，通过分片实现数据的分布式存储。


六、Redis高级特性

• Redis的过期策略有哪些？

• 答案：包括定时删除、惰性删除和定期删除。

• Redis的持久化方式有哪些？

• 答案：RDB（快照）和AOF（追加文件）。

• 如何使用Redis实现异步队列？

• 答案：可以使用Redis的列表数据结构（`LPUSH`和`RPOP`命令）实现。

• 如何使用Redis实现延时队列？

• 答案：可以使用Redis的`ZSET`（有序集合）和`ZADD`、`ZRANGE`命令实现。


七、缓存监控与优化

• 如何监控缓存的性能？

• 答案：可以使用Redis的`INFO`命令、`MONITOR`命令或第三方监控工具（如Prometheus、Grafana）。

• 如何优化缓存的内存使用？

• 答案：

• 合理设置过期时间：避免缓存中存储过多无用数据。

• 使用LRU算法：Redis内部使用LRU算法淘汰不常用的缓存。

• 内存压缩：对缓存数据进行压缩，减少内存占用。


八、缓存安全与可靠性

• 如何保证缓存服务的高可用性？

• 答案：

• 使用Redis Sentinel或Cluster：提供高可用性和故障转移。

• 依赖隔离组件：使用如Sentinel或Hystrix等组件进行限流和降级。

• 如何防止缓存被恶意攻击？

• 答案：

• 限制非法请求：在API入口处验证请求参数，防止恶意请求。

• 使用布隆过滤器：快速判断数据是否存在，避免查询数据库。


九、缓存设计案例

• 如何设计一个动态缓存热点数据的策略？

• 答案：可以通过分析日志或使用机器学习算法，动态识别热点数据，并将其缓存。

• 如何设计一个缓存操作与业务分离的架构？

• 答案：可以通过中间件或服务层来管理缓存操作，避免业务逻辑与缓存逻辑耦合。


十、缓存的未来趋势

• 缓存技术未来的发展方向是什么？

• 答案：

• 智能化：通过机器学习算法优化缓存策略。

• 分布式缓存的进一步发展：支持更大规模的数据存储和更高的并发。

• 与云原生技术的融合：支持容器化和微服务架构。

通过以上这些高频面试题的准备，你可以更好地掌握缓存相关的知识点，提升面试表现。