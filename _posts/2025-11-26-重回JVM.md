---
layout: post
title: Back To JVM
---

重回JVM
<!--more-->

## 1. JDK8默认Parallel GC

新生代对象使用 Eden + Survivor 复制算法，老年代采用标记整理算法做垃圾回收

高吞吐量的本质，是希望用户代码可以长久运行，垃圾回收时间尽可能短

这样设计问题的问题：
1. STW时间长，影响响应时间

## CMS做的补丁

为了降低Full GC的STW时间，老年代使用标记清除算法，并发标记阶段，用户线程继续运行，所以 STW 停顿短

缺点：
1. 不整理对象，导致老年代内存碎片，长期运行后导致Promotion Failed，触发Full GC
2. Full GC停顿无法预估，停顿时间可能比Parallel GC还长

## JDK9+的默认G1 GC

G1 的设计初衷：
1. 低停顿
2. 高吞吐量

核心设计思路：
1. 将堆划分为多个相同大小的的Region
